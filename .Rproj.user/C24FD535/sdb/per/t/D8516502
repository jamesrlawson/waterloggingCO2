{
    "contents" : "library(nlme)\nlibrary(lme4)\nlibrary(ez)\nlibrary(plyr)\nlibrary(ggplot2)\nlibrary(reshape2)\nlibrary(car)\nlibrary(effsize)\nlibrary(heplots)\nlibrary(MuMIn)\nlibrary(lsr)\n\nsource(\"scripts/functions.R\")\n\n## LICOR ##\n\n\nlicor <- read.csv(\"data/licor/licor_all1.csv\", header=TRUE)\n#licor <- subset(licor, treatment != \"waterlogged\")\ntraits <- read.csv(\"data/harvest/traits1.csv\", header=TRUE)\n\nlicor$species <- as.factor(licor$species)\nlicor$time <- as.factor(licor$time)\nlicor$treatment <- as.factor(licor$treatment)\nlicor$CO2 <- as.factor(licor$CO2)\nlicor$plant <- as.factor(licor$plant)\n\nlicor <- merge(licor, traits)\nlicor$photoMass <- licor$SLA * licor$photo\nlicor$condMass <- licor$SLA * licor$cond\n\nlicor$WUE <- licor$photo/licor$Trmmol\n\nlicor$treatment <- factor(licor$treatment, levels = c(\"control\", \"waterlogged\", \"recovery\"))\n\nlicor.A <- subset(licor, species == \"acacia\")\nlicor.C <- subset(licor, species == \"cas\")\nlicor.E <- subset(licor, species == \"euc\")\n\n\n# plot some graphs \n\nlicor.A_photo <- getSummary(licor.A, photo, acacia)\nlicor.A_cond <- getSummary(subset(licor.A, cond < 0.8), cond, acacia)\nlicor.A_WUE <- getSummary(licor.A, WUE, acacia)\nlicor.A_tr <- getSummary(licor.A, Trmmol, acacia)\n\n\nlicor.C_photo <- getSummary(licor.C, photo, cas)\nlicor.C_cond <- getSummary(licor.C, cond, cas)\nlicor.C_WUE <- getSummary(licor.C, WUE, cas)\nlicor.C_tr <- getSummary(licor.C, Trmmol, cas)\n\n\nlicor.E_photo <- getSummary(licor.E, photo, euc)\nlicor.E_cond <- getSummary(licor.E, cond, euc)\nlicor.E_WUE <- getSummary(licor.E, WUE, euc)\nlicor.E_tr <- getSummary(licor.E, Trmmol, euc)\n\n\nfacetPlot(licor.A_photo, acacia, photosyntheticRate)\nfacetPlot(licor.C_photo, casuarina, photosyntheticRate)\nfacetPlot(licor.E_photo, eucalyptus, photosyntheticRate)\n\nfacetPlot(licor.A_cond, acacia, stomatalConductance)\nfacetPlot(licor.C_cond, casuarina, stomatalConductance)\nfacetPlot(licor.E_cond, eucalyptus, stomatalConductance)\n\nfacetPlot(licor.A_WUE, acacia, WUE)\nfacetPlot(licor.C_WUE, casuarina, WUE)\nfacetPlot(licor.E_WUE, eucalyptus, WUE)\n\nfacetPlot(licor.A_tr, acacia, Trmmol)\nfacetPlot(licor.C_tr, casuarina, Trmmol)\nfacetPlot(licor.E_tr, eucalyptus, Trmmol)\n\n#licor.A_photoMass <- getSummary(licor.A, photoMass, acacia)\n#licor.C_photoMass <- getSummary(licor.C, photoMass, acacia)\n#licor.E_photoMass <- getSummary(licor.E, photoMass, acacia)\n\n#facetPlot(licor.A_photoMass, acacia, photosyntheticRateMass)\n#facetPlot(licor.C_photoMass, casuarina, photosyntheticRateMass)\n#facetPlot(licor.E_photoMass, eucalyptus, photosyntheticRateMass)\n\n#licor.A_condMass <- getSummary(licor.A, condMass, acacia)\n#licor.C_condMass <- getSummary(licor.C, condMass, acacia)\n#licor.E_condMass <- getSummary(licor.E, condMass, acacia)\n\n#facetPlot(licor.A_condMass, acacia, condsyntheticRateMass)\n#facetPlot(licor.C_condMass, casuarina, condsyntheticRateMass)\n#facetPlot(licor.E_condMass, eucalyptus, condsyntheticRateMass)\n\n\n# photosynthetic rate\n\n\nphoto.A <- aov(photo ~ CO2 * treatment, data = licor.A)\netaSquared(photo.A, anova = TRUE)\n\nphoto.C <- aov(photo ~ CO2 * treatment, data = licor.C)\netaSquared(photo.C, anova = TRUE)\n\nphoto.E <- aov(photo ~ CO2 * treatment, data = licor.E)\netaSquared(photo.E, anova = TRUE)\n\n\n# transpiration\n\nTrmmol.A <- aov(Trmmol ~ CO2 * treatment, data = licor.A)\netaSquared(Trmmol.A, anova = TRUE)\n\n\nTrmmol.C <- aov(Trmmol ~ CO2 * treatment, data = licor.C)\netaSquared(Trmmol.C, anova = TRUE)\n\nTrmmol.E <- aov(Trmmol ~ CO2 * treatment, data = licor.E)\netaSquared(Trmmol.E, anova = TRUE)\n\n\n\n# water use efficiency\n\nWUE.A <- aov(WUE ~ CO2 * treatment, data = licor.A)\netaSquared(WUE.A, anova = TRUE)\n\nWUE.C <- aov(WUE ~ CO2 * treatment, data = licor.C)\netaSquared(WUE.C, anova = TRUE)\n\nWUE.E <- aov(WUE ~ CO2 * treatment, data = licor.E)\netaSquared(WUE.E, anova = TRUE)\n\n\n# stomatal conductance\n\ncond.A <- aov(cond ~ CO2 * treatment, data = licor.A)\netaSquared(cond.A, anova = TRUE)\n\ncond.C <- aov(cond ~ CO2 * treatment, data = licor.C)\netaSquared(cond.C, anova = TRUE)\n\ncond.E <- aov(cond ~ CO2 * treatment, data = licor.E)\netaSquared(cond.E, anova = TRUE)\n\n\n## TRAITS ##\n\ntraits <- read.csv(\"data/harvest/traits1.csv\", header=T)\n#traits <- subset(traits, treatment != \"waterlogged\")\ntraits$dryBiomass <- traits$dryRootBiomass + traits$dryShootBiomass\n\ntraits <- data.frame(cbind(\n  traits[\"species\"],\n  traits[\"plant\"],\n  traits[\"CO2\"],\n  traits[\"treatment\"],\n  traits[\"dryBiomass\"],\n  traits[\"dryRootBiomass\"], \n  traits[\"dryFineRootMass\"],\n  traits[\"dryShootBiomass\"],\n  traits[\"RMF\"],\n  traits[\"rootFineProportion\"],\n  traits[\"fineRootDMC\"],\n  traits[\"coarseRootDMC\"],\n  traits[\"SLA\"], \n  traits[\"stemDensity\"]))\n\ntraits$treatment <- factor(traits$treatment, levels = c(\"control\", \"waterlogged\", \"recovery\"))\n\n#traits <- subset(traits, treatment != \"waterlogged\")\n\ntraits.A <- subset(traits, species == \"acacia\")\ntraits.C <- subset(traits, species == \"cas\")\ntraits.E <- subset(traits, species == \"euc\")\n\nplot.means(traits.A, acacia)\nplot.means(traits.C, casuarina)\nplot.means(traits.E, eucalyptus)\n\nrootFineProportion.A <- getSummary_traits(traits.A, rootFineProportion, acacia)\nrootFineProportion.C <- getSummary_traits(traits.C, rootFineProportion, cas)\nrootFineProportion.E <- getSummary_traits(traits.E, rootFineProportion, euc)\n\nSLA.A <- getSummary_traits(traits.A, SLA, acacia)\nSLA.C <- getSummary_traits(traits.C, SLA, cas)\nSLA.E <- getSummary_traits(traits.E, SLA, euc)\n\nRMF.A <- getSummary_traits(traits.A, RMF, acacia)\nRMF.C <- getSummary_traits(traits.C, RMF, cas)\nRMF.E <- getSummary_traits(traits.E, RMF, euc)\n\nfineRootDMC.A <- getSummary_traits(traits.A, fineRootDMC, acacia)\nfineRootDMC.C <- getSummary_traits(traits.C, fineRootDMC, cas)\nfineRootDMC.E <- getSummary_traits(traits.E, fineRootDMC, euc)\n\nstemDensity.A <- getSummary_traits(na.omit(traits.A), stemDensity, acacia)\nstemDensity.C <- getSummary_traits(na.omit(subset(traits.C,, stemDensity > 0.15)), stemDensity, cas) # remove outlier\nstemDensity.E <- getSummary_traits(traits.E, stemDensity, euc)\n\ntraits1 <- traits\n\ntraits.A1 <- traits.A\ntraits.C1 <- traits.C\ntraits.E1 <- traits.E\n\n\ntraits <- read.csv(\"data/harvest/traits1.csv\", header=T)\ntraits$dryBiomass <- traits$dryRootBiomass + traits$dryShootBiomass\n\ntraits <- data.frame(cbind(\n  traits[\"species\"],\n  traits[\"plant\"],\n  traits[\"CO2\"],\n  traits[\"treatment\"],\n  sqrt(traits[\"dryBiomass\"]),\n  sqrt(traits[\"dryRootBiomass\"]), \n  sqrt(traits[\"dryFineRootMass\"]),\n  sqrt(traits[\"dryShootBiomass\"]),\n  log10(traits[\"RMF\"]),\n  traits[\"rootFineProportion\"],\n  traits[\"fineRootDMC\"],\n  log10(traits[\"SLA\"]), \n  traits[\"stemDensity\"]))\n\n#traits <- subset(traits, stemDMC > 0.15)\n\n\n# find outliers\n#plot(traits$dryRootBiomass)\n#plot(traits$rootFineProportion)\n#plot(traits$dryFineRootMass)\n#plot(traits$dryShootBiomass)\n#plot(traits$SLA)\n#plot(traits$LDMC)\n#plot(traits$stemDMC)\n#pot(traits$RMF)\n#plot(traits$fineRootDMC)\n\n\ntraits.A <- subset(traits, species == \"acacia\")\ntraits.C <- subset(traits, species == \"cas\")\ntraits.E <- subset(traits, species == \"euc\")\n\n\nrootFineProportion.A.aov <- aov(rootFineProportion ~ CO2 * treatment, data = traits.A)\netaSquared(rootFineProportion.A.aov, anova = TRUE)\nrootFineProportion.C.aov <- aov(rootFineProportion ~ CO2 * treatment, data = traits.C)\netaSquared(rootFineProportion.C.aov, anova = TRUE)\nTukeyHSD(rootFineProportion.C.aov)\nrootFineProportion.E.aov <- aov(rootFineProportion ~ CO2 * treatment, data = traits.E)\netaSquared(rootFineProportion.E.aov, anova = TRUE)\n\n\nSLA.A.aov <- aov(SLA ~ CO2 * treatment, data = traits.A)\netaSquared(SLA.A.aov, anova = TRUE)\nSLA.C.aov <- aov(SLA ~ CO2 * treatment, data = traits.C)\netaSquared(SLA.C.aov, anova = TRUE)\ntraits.E <- subset(traits.E, SLA < 1.65)\nSLA.E.aov <- aov(SLA ~ CO2 * treatment, data = traits.E)\netaSquared(SLA.E.aov, anova = TRUE)\ntraits.E <- subset(traits.E, species == \"euc\")\n\n\nRMF.A.aov <- aov(RMF ~ CO2 * treatment, data = traits.A)\netaSquared(RMF.A.aov, anova = TRUE)\nTukeyHSD(RMF.A.aov)\nRMF.C.aov <- aov(RMF ~ CO2 * treatment, data = traits.C)\netaSquared(RMF.C.aov, anova = TRUE)\nRMF.E.aov <- aov(RMF ~ CO2 * treatment, data = traits.E)\netaSquared(RMF.E.aov, anova = TRUE)\n\n\nfineRootDMC.A.aov <- aov(fineRootDMC ~ CO2 * treatment, data = traits.A)\netaSquared(fineRootDMC.A.aov, anova = TRUE)\nTukeyHSD(fineRootDMC.A.aov)\nfineRootDMC.C.aov <- aov(fineRootDMC ~ CO2 * treatment, data = traits.C)\netaSquared(fineRootDMC.C.aov, anova = TRUE)\nfineRootDMC.E.aov <- aov(fineRootDMC  ~ CO2 * treatment, data = traits.E)\netaSquared(fineRootDMC.E.aov, anova = TRUE)\n\n\nstemDensity.A.aov <- aov(stemDensity ~ CO2 * treatment, data = traits.A)\netaSquared(stemDensity.A.aov, anova = TRUE)\ntraits.C <- subset(traits.C, stemDensity < 1)\nstemDensity.C.aov <- aov(stemDensity ~ CO2 * treatment, data = traits.C)\netaSquared(stemDensity.C.aov, anova = TRUE)\nstemDensity.E.aov <- aov(stemDensity ~ CO2 * treatment, data = traits.E)\netaSquared(stemDensity.E.aov, anova = TRUE)\n\n\nRMF.A.aov <- aov(RMF ~ CO2 * treatment, data = traits.A)\netaSquared(RMF.A.aov, anova = TRUE)\nTukeyHSD(RMF.A.aov)\nRMF.C.aov <- aov(RMF ~ CO2 * treatment, data = traits.C)\netaSquared(RMF.C.aov, anova = TRUE)\nRMF.E.aov <- aov(RMF ~ CO2 * treatment, data = traits.E)\netaSquared(RMF.E.aov, anova = TRUE)\n\n\n\n# removing waterlogged treatment for biomass comparisons\n\n\ntraits1 <- subset(traits1, treatment != \"waterlogged\")\n\ntraits.A1 <- subset(traits1, species == \"acacia\")\ntraits.C1 <- subset(traits1, species == \"cas\")\ntraits.E1 <- subset(traits1, species == \"euc\")\n\ndryBiomass.A <- getSummary_traits(traits.A1, dryBiomass, acacia)\ndryBiomass.C <- getSummary_traits(traits.C1, dryBiomass, cas)\ndryBiomass.E <- getSummary_traits(traits.E1, dryBiomass, euc)\n\ndryRootBiomass.A <- getSummary_traits(traits.A1, dryRootBiomass, acacia)\ndryRootBiomass.C <- getSummary_traits(traits.C1, dryRootBiomass, cas)\ndryRootBiomass.E <- getSummary_traits(traits.E1, dryRootBiomass, euc)\n\ndryFineRootMass.A <- getSummary_traits(traits.A1, dryFineRootMass, acacia)\ndryFineRootMass.C <- getSummary_traits(traits.C1, dryFineRootMass, cas)\ndryFineRootMass.E <- getSummary_traits(traits.E1, dryFineRootMass, euc)\n\ndryShootBiomass.A <- getSummary_traits(traits.A1, dryShootBiomass, acacia)\ndryShootBiomass.C <- getSummary_traits(traits.C1, dryShootBiomass, cas)\ndryShootBiomass.E <- getSummary_traits(traits.E1, dryShootBiomass, euc)\n\n\ntraits <- subset(traits, treatment != \"waterlogged\")\ntraits.A <- subset(traits, species == \"acacia\")\ntraits.C <- subset(traits, species == \"cas\")\ntraits.E <- subset(traits, species == \"euc\")\n\ndryBiomass.A.aov <- aov(dryBiomass ~ CO2 * treatment, data = traits.A)\netaSquared(dryBiomass.A.aov, anova = TRUE)\ndryBiomass.C.aov <- aov(dryBiomass ~ CO2 * treatment, data = traits.C)\netaSquared(dryBiomass.C.aov, anova = TRUE)\nTukeyHSD(dryBiomass.C.aov)\ndryBiomass.E.aov <- aov(dryBiomass ~ CO2 * treatment, data = traits.E)\netaSquared(dryBiomass.E.aov, anova = TRUE)\n\n\ndryFineRootMass.A.aov <- aov(dryFineRootMass ~ CO2 * treatment, data = traits.A)\netaSquared(dryFineRootMass.A.aov, anova = TRUE)\ndryFineRootMass.C.aov <- aov(dryFineRootMass ~ CO2 * treatment, data = traits.C)\netaSquared(dryFineRootMass.C.aov, anova = TRUE)\ndryFineRootMass.E.aov <- aov(dryFineRootMass ~ CO2 * treatment, data = traits.E)\netaSquared(dryFineRootMass.E.aov, anova = TRUE)\n\n\ndryRootBiomass.A.aov <- aov(dryRootBiomass ~ CO2 * treatment, data = traits.A)\netaSquared(dryRootBiomass.A.aov, anova = TRUE)\ndryRootBiomass.C.aov <- aov(dryRootBiomass ~ CO2 * treatment, data = traits.C)\netaSquared(dryRootBiomass.C.aov, anova = TRUE)\nTukeyHSD(dryRootBiomass.C.aov)\ndryRootBiomass.E.aov <- aov(dryRootBiomass ~ CO2 * treatment, data = traits.E)\netaSquared(dryRootBiomass.E.aov, anova = TRUE)\n\n\ndryShootBiomass.A.aov <- aov(dryShootBiomass ~ CO2 * treatment, data = traits.A)\netaSquared(dryShootBiomass.A.aov, anova = TRUE)\ndryShootBiomass.C.aov <- aov(dryShootBiomass ~ CO2 * treatment, data = traits.C)\netaSquared(dryShootBiomass.C.aov, anova = TRUE)\nTukeyHSD(dryShootBiomass.C.aov)\ndryShootBiomass.E.aov <- aov(dryShootBiomass ~ CO2 * treatment, data = traits.E)\netaSquared(dryShootBiomass.E.aov, anova = TRUE)\n\nRMF.A.aov <- aov(RMF ~ CO2 * treatment, data = traits.A)\netaSquared(RMF.A.aov, anova = TRUE)\nTukeyHSD(RMF.A.aov)\nRMF.C.aov <- aov(RMF ~ CO2 * treatment, data = traits.C)\netaSquared(RMF.C.aov, anova = TRUE)\nRMF.E.aov <- aov(RMF ~ CO2 * treatment, data = traits.E)\netaSquared(RMF.E.aov, anova = TRUE)\n\n\n\n\n\n# adonis\n\nlibrary(vegan)\n\ntraits.A_ <- traits.A[6:12]\ntraits.A_ <- na.omit(traits.A_)\ntraits.A.dist <- vegdist(traits.A_)\ntraits.A.adonis <- adonis(traits.A.dist ~ CO2 * treatment, data = traits.A)\nprint(traits.A.adonis)\n\ntraits.C_ <- traits.C[6:12]\ntraits.C_ <- na.omit(traits.C_)\ntraits.C.dist <- vegdist(traits.C_)\ntraits.C.adonis <- adonis(traits.C.dist ~ CO2 * treatment, data = traits.C)\nprint(traits.C.adonis)\n\ntraits.E_ <- traits.E[6:12]\ntraits.E_ <- na.omit(traits.E_)\ntraits.E.dist <- vegdist(traits.E_)\ntraits.E.adonis <- adonis(traits.E.dist ~ CO2 * treatment, data = traits.E)\nprint(traits.E.adonis)\n\n# pca \n\nA.pca <- prcomp(traits.A_, scale.=TRUE, centre = TRUE)\nC.pca <- prcomp(traits.C_, scale.=TRUE, centre = TRUE)\nE.pca <- prcomp(traits.E_, scale.=TRUE, centre = TRUE)\n\nsummary(A.pca)\nsummary(C.pca)\nsummary(E.pca)\n\nbiplot(A.pca)\n\n\n# trait correlations\n\ncor(traits.A_)\ncor(traits.C_)\ncor(traits.E_)\n\nplot(traits.A$rootFineProportion, traits.A$fineRootDMC)\nrootsA.A.aov <- aov(fineRootDMC ~ rootFineProportion, data = subset(traits.A, CO2 == \"E\"))\nrootsA.E.aov <- aov(fineRootDMC ~ rootFineProportion, data = subset(traits.A, CO2 == \"A\"))\nabline(rootsA.A.aov)\nabline(rootsA.E.aov)\nsummary(rootsA.A.aov)\nsummary(rootsA.E.aov)\n\nplot(traits.C$rootFineProportion, traits.C$fineRootDMC)\nrootsC.A.aov <- aov(fineRootDMC ~ rootFineProportion, data = subset(traits.C, CO2 == \"E\"))\nrootsC.E.aov <- aov(fineRootDMC ~ rootFineProportion, data = subset(traits.C, CO2 == \"A\"))\nabline(rootsC.A.aov)\nabline(rootsC.E.aov)\nsummary(rootsC.A.aov)\nsummary(rootsC.E.aov)\n\nplot(traits.E$rootFineProportion, traits.E$fineRootDMC)\nrootsE.A.aov <- aov(fineRootDMC ~ rootFineProportion, data = subset(traits.E, CO2 == \"E\"))\nrootsE.E.aov <- aov(fineRootDMC ~ rootFineProportion, data = subset(traits.E, CO2 == \"A\"))\nabline(rootsE.A.aov)\nabline(rootsE.E.aov)\nsummary(rootsE.A.aov)\nsummary(rootsE.E.aov)\n\n\n\n\n\n\n\n",
    "created" : 1423017314717.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2336114308",
    "id" : "D8516502",
    "lastKnownWriteTime" : 1434611801,
    "path" : "C:/Users/James/Desktop/stuff/glasshouse/glasshouse proj/scripts/analysis_full.R",
    "project_path" : "scripts/analysis_full.R",
    "properties" : {
        "tempName" : "Untitled4"
    },
    "relative_order" : 0,
    "source_on_save" : false,
    "type" : "r_source"
}