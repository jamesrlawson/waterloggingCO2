{
    "contents" : "library(nlme)\nlibrary(lme4)\nlibrary(ez)\nlibrary(plyr)\nlibrary(ggplot2)\nlibrary(reshape2)\n\ngetSummary <- function(df, measurement, species) {\n  \n  measurement <- deparse(substitute(measurement))\n  \n  df_melted <- melt(df)\n  #df_melted <- na.omit(df_melted)\n  df_melted <- subset(df_melted, variable == measurement)\n  \n  stats <- ddply(df_melted, .(CO2, treatment), summarise, \n                 mean = mean(value),\n                 sd = sd(value),\n                 sem = sd(value)/sqrt(length(value)))\n  stats <- transform(stats, lower=mean-sem, upper=mean+sem)\n  \n}\n\n\ngetSummary_traits <- function(df, measurement, species) {\n  \n  measurement <- deparse(substitute(measurement))\n  \n  df_melted <- melt(df)\n  #df_melted <- na.omit(df_melted)\n  df_melted <- subset(df_melted, variable == measurement)\n  \n  stats <- ddply(df_melted, .(CO2, treatment), summarise, \n                 mean = mean(value),\n                 sd = sd(value),\n                 sem = sd(value)/sqrt(length(value)))\n  stats <- transform(stats, lower=mean-sem, upper=mean+sem)\n  \n}\n\nfacetPlot <- function(df, species, measurement) {\n  \n  measurement <- deparse(substitute(measurement))\n  \n  figureDir <- \"C:/Users/James/Desktop/stuff/glasshouse/glasshouse proj/output/figures/licor\"\n  species <- deparse(substitute(species))  \n  outDir <- sprintf(\"%s\", figureDir)\n  dir.create(outDir, recursive=TRUE)\n  \n  png(sprintf(\"%s/%s_%s.png\", outDir, species, measurement), width = 800, height = 600)\n  \n  plot <- ggplot(df, aes(treatment, mean, fill=CO2)) \n  plot <- plot + geom_bar(aes(fill = CO2), stat = \"identity\", position=\"dodge\") \n  plot = plot + scale_fill_grey()\n  plot <- plot + ylab(bquote('Photosynthetic rate ('*mu~ 'mol' ~CO[2]~ m^-2~s^-1*')'))\n#  plot <- plot + ylab(bquote('Transpiration rate ('*m~ 'mol' ~H[2]~O~ m^-2~s^-1*')'))\n#  plot <- plot + ylab(\"WUE (Photosynthetic rate / transpiration rate)\")\n\n  plot <- plot + geom_errorbar(aes(ymax=upper,\n                                   ymin=lower),\n                               position=position_dodge(0.9),\n                               data=df)    \n  #plot <- plot + ggtitle(paste(species, measurement))\n  plot <- plot + theme_bw()  \n  plot <- plot + theme(axis.title.x=element_blank(),\n                       panel.border = element_blank(),\n                       panel.grid.minor = element_blank(),\n                       panel.grid.major = element_blank(),\n                       axis.line = element_line(size=.2, color = \"black\")\n                       )\n\n  print(plot)\n  \n  dev.off()\n  \n}\n\nplot.means <- function(df, species) {\n  \n  figureDir <- \"C:/Users/James/Desktop/stuff/glasshouse/glasshouse proj/output/figures\"\n  species <- deparse(substitute(species))\n  \n  outDir <- sprintf(\"%s/%s\", figureDir, species)\n  \n  dir.create(outDir, recursive=TRUE)\n  \n  \n  df_melted <- melt(df)\n  df_melted <- na.omit(df_melted)\n  \n  stats <- ddply(df_melted, .(CO2, treatment, variable), summarise, \n                 mean = mean(value),\n                 sem = sd(value)/sqrt(length(value)))\n  stats <- transform(stats, lower=mean-sem, upper=mean+sem)\n  \n  \n  for(i in 1:nrow(stats)) {      \n    \n    trait <- (stats[i,3])\n    traitName <- deparse(substitute(trait))\n    \n    traitStats <- subset(stats, variable == trait)\n    traitStats <- traitStats[-3]\n    \n    png(sprintf(\"%s/%s.png\", outDir, trait), width = 800, height = 600)\n    \n    plot <- ggplot(traitStats, aes(treatment, mean, fill=CO2)) \n    plot <- plot + geom_bar(stat = \"identity\", position=\"dodge\") \n    \n    plot <- plot + geom_errorbar(aes(ymax=upper,\n                                     ymin=lower),\n                                 position=position_dodge(0.9),\n                                 data=traitStats)    \n    plot <- plot + ylab(trait)  \n    \n    print(plot)\n    \n    dev.off()\n    \n  }\n  \n}\n\nplot.means_facet <- function(df, species) {\n  \n  figureDir <- \"C:/Users/James/Desktop/stuff/glasshouse/glasshouse proj/output/figures/traits\"\n  species <- deparse(substitute(species))\n  \n  outDir <- figureDir\n  \n  dir.create(outDir, recursive=TRUE)\n  \n  df_melted <- melt(df)\n  df_melted <- na.omit(df_melted)\n  \n  stats <- ddply(df_melted, .(CO2, treatment, variable), summarise, \n                 mean = mean(value),\n                 sem = sd(value)/sqrt(length(value)))\n  stats <- transform(stats, lower=mean-sem, upper=mean+sem)\n  \n  \n  png(sprintf(\"%s/%s_traitfacet.png\", outDir, species), width = 1500, height = 900)\n  \n  plot <- ggplot(stats, aes(treatment, mean, fill=CO2)) \n  plot <- plot + geom_bar(stat = \"identity\", position=\"dodge\")    \n  plot <- plot + facet_wrap(~ variable, scales = \"free\") \n  plot <- plot + geom_errorbar(aes(ymax=upper,\n                                   ymin=lower),\n                               position=position_dodge(0.9),\n                               data=stats)    \n  plot <- plot + ggtitle(paste(species))  \n  \n  print(plot)\n  \n  dev.off()      \n  \n}\n\n\n\n\n\n",
    "created" : 1421975111568.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1166112073",
    "id" : "CBE5701B",
    "lastKnownWriteTime" : 1425971843,
    "path" : "C:/Users/James/Desktop/stuff/glasshouse/glasshouse proj/scripts/functions.R",
    "project_path" : "scripts/functions.R",
    "properties" : {
        "tempName" : "Untitled7"
    },
    "source_on_save" : true,
    "type" : "r_source"
}